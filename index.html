<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Global Voyages & Hospitality — Courier Chat</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{--bg:#000;--gold:#d4af37;--muted:#cfcfcf}
    body{margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:var(--bg);color:#eee}
    .wrap{max-width:520px;margin:28px auto;padding:18px}
    .card{background:#071017;border-radius:14px;padding:16px;border:1px solid rgba(212,175,55,0.06)}
    header{display:flex;align-items:center;gap:12px}
    .logo{width:72px;height:72px;border-radius:10px;overflow:hidden;background:#0b0b0b}
    .logo img{width:100%;height:100%;object-fit:cover;display:block}
    h1{margin:0;font-size:20px;color:var(--gold)}
    p.small{color:var(--muted);margin:6px 0 12px;font-size:13px}
    label{display:block;margin-top:8px;color:var(--muted);font-size:13px}
    input,textarea,select{width:100%;padding:9px;border-radius:8px;border:1px solid #12222a;background:#061017;color:#fff;margin-top:6px}
    button{background:var(--gold);border:none;padding:10px 14px;border-radius:10px;font-weight:700;color:#051018;cursor:pointer;margin-top:12px}
    .messages{margin-top:14px;background:#061017;padding:10px;border-radius:8px;max-height:320px;overflow:auto;border:1px solid rgba(212,175,55,0.03)}
    .msg{padding:8px;border-radius:8px;margin-bottom:8px}
    .msg.guest{background:#08202a;color:#fff;text-align:left}
    .msg.admin{background:var(--gold);color:#051018;text-align:left}
    .meta{font-size:12px;color:#9aa;margin-top:4px}
    .footer{margin-top:12px;color:var(--muted);font-size:13px;text-align:center}
    .small-note{font-size:12px;color:#9aa;margin-top:8px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <div class="logo"><img src="logo.png" alt="GVH Logo" /></div>
        <div>
          <h1>Global Voyages &amp; Hospitality</h1>
          <div class="small">Courier Service — Domestic &amp; International</div>
        </div>
      </header>

      <p class="small">Ask about pickup, pricing or tracking. Our team will reply here in the chat.</p>

      <label>Name</label>
      <input id="name" placeholder="Your name">

      <label>Phone</label>
      <input id="phone" placeholder="+91 9xxxxxxxxx">

      <label>Pickup area</label>
      <input id="pickup" placeholder="Pickup address / area">

      <label>Destination</label>
      <input id="dest" placeholder="Delivery address / city">

      <label>Message (parcel details)</label>
      <textarea id="message" rows="3" placeholder="Describe the parcel, weight, urgent?"></textarea>

      <button id="sendBtn">Send Message</button>

      <div class="messages" id="messages"></div>

      <div class="small-note">If you prefer to call: <strong>9547508342 / 7001443800</strong></div>
      <div class="footer">Address: Vill &amp; P.O. – Fatepur, P.S. – Falta, Dist. – South 24 Parganas, West Bengal — PIN: 743515</div>
    </div>
  </div>

  <!-- Firebase compat SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.25.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.25.0/firebase-database-compat.js"></script>

  <script>
    // ====== PASTE YOUR FIREBASE CONFIG OBJECT BELOW ======
    // Replace FIREBASE_CONFIG_HERE with your config, e.g.:
    /*
    const firebaseConfig = {
      apiKey: "AIza....",
      authDomain: "yourproject.firebaseapp.com",
      databaseURL: "https://yourproject-default-rtdb.firebaseio.com",
      projectId: "yourproject",
      storageBucket: "yourproject.appspot.com",
      messagingSenderId: "123456789",
      appId: "1:123:web:abcd"
    };
    */
    const firebaseConfig = FIREBASE_CONFIG_HERE;
    // =====================================================

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // create or get a guestId for this browser session
    let guestId = localStorage.getItem('gvh_guestId');
    if(!guestId){
      guestId = 'g_'+Math.random().toString(36).slice(2,10);
      localStorage.setItem('gvh_guestId', guestId);
    }

    const nameIn = document.getElementById('name');
    const phoneIn = document.getElementById('phone');
    const pickupIn = document.getElementById('pickup');
    const destIn = document.getElementById('dest');
    const msgIn = document.getElementById('message');
    const sendBtn = document.getElementById('sendBtn');
    const messagesDiv = document.getElementById('messages');

    function appendMessage(text, cls, meta){
      const el = document.createElement('div');
      el.className = 'msg ' + cls;
      el.innerHTML = `<div>${text}</div>` + (meta?`<div class="meta">${meta}</div>`:'');
      messagesDiv.appendChild(el);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    sendBtn.addEventListener('click', () => {
      const name = nameIn.value.trim() || 'Guest';
      const phone = phoneIn.value.trim() || '';
      const pickup = pickupIn.value.trim() || '';
      const dest = destIn.value.trim() || '';
      const text = msgIn.value.trim();

      if(!text) return alert('Write a message before sending.');

      const payload = {
        guestId,
        name,
        phone,
        pickup,
        dest,
        message: text,
        timestamp: Date.now(),
        status: 'new',
        from: 'guest'
      };

      // push to database
      db.ref('chats').push(payload)
        .then(() => {
          appendMessage('You: ' + text, 'guest', 'Waiting for reply...');
          msgIn.value = '';
        })
        .catch(err => alert('Send failed: ' + err.message));
    });

    // Listen for admin replies for this guest (replies are saved under chats/<key>/replies)
    db.ref('chats').on('child_changed', snap => {
      const data = snap.val();
      // if this chat belongs to this guest
      if(data && data.guestId === guestId){
        // show any replies
        if(data.replies){
          const keys = Object.keys(data.replies);
          keys.forEach(k => {
            const r = data.replies[k];
            appendMessage('GVH: ' + r.message, 'admin', new Date(r.ts).toLocaleString());
          });
          // after displaying replies, optionally clear replies node (not required)
        }
      }
    });

    // Show a message count on load (optional)
    db.ref('chats').once('value').then(snap => {
      const count = snap.numChildren();
      if(count>0){
        const el = document.createElement('div');
        el.className = 'msg';
        el.style.background='transparent';
        el.style.border='none';
        el.innerHTML = `<div class="meta">Messages in queue: ${count}</div>`;
        messagesDiv.appendChild(el);
      }
    });
  </script>
</body>
</html>
